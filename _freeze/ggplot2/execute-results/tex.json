{
  "hash": "75ed3f227d221ec1e141a21d2ae2f850",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Introduction to ggplot2: Creating publication-ready visualizations\"\nauthor: \"Andrew Silhavy & Shane McCarty, PhD\"\nabstract: |\n  This chapter introduces students to the ggplot2 package, a powerful tool for creating sophisticated and publication-ready data visualizations in R. Students learn the foundational \"grammar of graphics\" approach, which builds plots layer by layer using seven core components: data, mapping, geometries, facets, statistics, coordinates, and  themes. Through hands-on examples using insurance data, the chapter demonstrates how to construct various plot types including scatterplots, bar plots, and violin plots. \n  Students explore how to visualize relationships between variables, incorporate grouping variables using color and faceting, and customize plots with titles, labels, and themes. By the end of this chapter, students will understand how to select appropriate visualizations based on data types and create professional-quality figures for their public health research.\nkeywords:\n  - ggplot2\n  - data visualization\n  - grammar of graphics\n  - R\n  - exploratory data analysis\nformat: html\neditor: visual\nexecute:\n  warning: false\n  message: false\n---\n\n::: callout-tip\n## 📖 Learning Resources\n\n-   **R for Data Science**: [Data Visualization](https://r4ds.hadley.nz/data-visualize.html)\n-   **R for Data Science**: [Visualize](https://r4ds.hadley.nz/visualize.html)\n-   **Datacamp Course**: [ggplot2](https://www.datacamp.com/courses/introduction-to-data-visualization-with-ggplot2)\n-   **Cheat Sheet**: [ggplot2](https://rstudio.github.io/cheatsheets/data-visualization.pdf)\n-   **Posit Interactive Page**: [ggplot2](https://rstudio.github.io/cheatsheets/html/data-visualization.html)\n:::\n\n## The ggplot2 Package\n\nRecall: Packages are collections of code, data, and documentation that add extra functionality not included in base R.\n\nTo install and load ggplot2:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"ggplot2\")\n```\n:::\n\n\n## Example Dataset: Insurance Charges\n\nLet's start by loading our dataset and exploring it:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninsurance <- read.csv(\"data/insurance.csv\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n:::\n\n\n### Summarizing Our Data\n\nLet's learn more about our data with `summary()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(insurance)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      age            sex                 bmi           children    \n Min.   :18.00   Length:1338        Min.   :15.96   Min.   :0.000  \n 1st Qu.:27.00   Class :character   1st Qu.:26.30   1st Qu.:0.000  \n Median :39.00   Mode  :character   Median :30.40   Median :1.000  \n Mean   :39.21                      Mean   :30.66   Mean   :1.095  \n 3rd Qu.:51.00                      3rd Qu.:34.69   3rd Qu.:2.000  \n Max.   :64.00                      Max.   :53.13   Max.   :5.000  \n    smoker             region             charges     \n Length:1338        Length:1338        Min.   : 1122  \n Class :character   Class :character   1st Qu.: 4740  \n Mode  :character   Mode  :character   Median : 9382  \n                                       Mean   :13270  \n                                       3rd Qu.:16640  \n                                       Max.   :63770  \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(insurance, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   age    sex    bmi children smoker    region   charges\n1   19 female 27.900        0    yes southwest 16884.924\n2   18   male 33.770        1     no southeast  1725.552\n3   28   male 33.000        3     no southeast  4449.462\n4   33   male 22.705        0     no northwest 21984.471\n5   32   male 28.880        0     no northwest  3866.855\n6   31 female 25.740        0     no southeast  3756.622\n7   46 female 33.440        1     no southeast  8240.590\n8   37 female 27.740        3     no northwest  7281.506\n9   37   male 29.830        2     no northeast  6406.411\n10  60 female 25.840        0     no northwest 28923.137\n```\n\n\n:::\n:::\n\n\n## The Seven Components of ggplot2\n\nThink of building a ggplot like making a layered lasagna - you add one component at a time to create the final product. The seven components are:\n\n1.  **Data**: The dataset you're visualizing\n\n2.  **Mapping**: Which variables go on which axes (aesthetics)\n\n3.  **Geometries**: The type of plot (points, lines, bars, etc.)\n\n4.  **Facets**: Subplots based on categorical variables\n\n5.  **Statistics**: Statistical transformations of the data\n\n6.  **Coordinates**: The coordinate system (usually Cartesian)\n\n7.  **Theme**: Visual styling and appearance\n\n![In ggplot2, add layers as you would in making lasagna](Lasagna.png)\n\n## Understanding Data Types\n\nBefore creating visualizations, it's important to understand your data types:\n\n**Qualitative Data:**\n\n-   🏷️ **Nominal Data**: Categories without any order (e.g., Red, Green, Blue)\n\n-   📶 **Ordinal Data**: Categories with some order (e.g., Small, Medium, Large)\n\n**Quantitative Data:**\n\n-   🔢 **Discrete**: Countable data (e.g., number of people in a room)\n\n-   📏 **Continuous**: Measurable data (e.g., height, weight)\n\n## Building a Plot Step by Step\n\n### Step 1: Data and Mapping\n\nWhat is the relationship between BMI and insurance charges?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = insurance, mapping = aes(x = bmi, y = charges))\n```\n\n::: {.cell-output-display}\n![](ggplot2_files/figure-pdf/unnamed-chunk-1-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nThis creates a blank canvas with our axes defined, but no data displayed yet!\n\n### Step 2: Adding Layers with Geometries\n\nAdd points to create a scatterplot using `geom_point()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = insurance, mapping = aes(x = bmi, y = charges)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![](ggplot2_files/figure-pdf/unnamed-chunk-2-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n### Step 3: Adding a Trend Line\n\nAdd a linear model line with `geom_smooth()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = insurance, mapping = aes(x = bmi, y = charges)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](ggplot2_files/figure-pdf/unnamed-chunk-3-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nNotice how it looks like we have two different populations? Let's explore this further.\n\n## Incorporating Grouping Variables\n\nThere are two main approaches to visualizing grouping variables:\n\n### Method 1: Using Color\n\nMap the `smoker` variable to color:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = insurance, \n       mapping = aes(x = bmi, y = charges, color = smoker)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](ggplot2_files/figure-pdf/unnamed-chunk-4-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n### Method 2: Using Facets\n\nCreate separate panels for each group with `facet_wrap()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = insurance, mapping = aes(x = bmi, y = charges)) +\n  geom_point() +\n  geom_smooth(method = \"lm\") +\n  facet_wrap(~smoker)\n```\n\n::: {.cell-output-display}\n![](ggplot2_files/figure-pdf/unnamed-chunk-5-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nBoth methods reveal that smoking status significantly affects the relationship between BMI and insurance charges!\n\n## Customizing with Themes\n\n### Adding Titles and Labels\n\nMake your plot more informative with descriptive titles:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = insurance, mapping = aes(x = bmi, y = charges, color = smoker)) +\n  geom_point() +\n  geom_smooth(method = \"lm\") +\n  ggtitle(\"Insurance charges vs BMI for smokers and non-smokers\") +\n  xlab(\"Body Mass Index (BMI)\") +\n  ylab(\"Insurance Charges\")\n```\n\n::: {.cell-output-display}\n![](ggplot2_files/figure-pdf/unnamed-chunk-6-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n### Changing the Theme\n\nApply a professional theme with `theme_bw()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = insurance, mapping = aes(x = bmi, y = charges, color = smoker)) +\n  geom_point() +\n  geom_smooth(method = \"lm\") +\n  ggtitle(\"Insurance charges vs BMI for smokers and non-smokers\") +\n  xlab(\"Body Mass Index (BMI)\") +\n  ylab(\"Insurance Charges\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![a scatterplot depicting a linear relationship between BMI and insurance charges](ggplot2_files/figure-pdf/ggplot with black and white theme-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n## Other Common Plot Types\n\n### Bar Plots with `geom_bar()`\n\nBar plots are useful for comparing means across categories:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = insurance, mapping = aes(x = region, y = charges)) + \n  geom_bar(stat = 'summary', fun = 'mean', fill = \"#005a43\") + \n  ggtitle(\"Mean Insurance Charges Based on Region\") + \n  xlab(\"Region\") +\n  ylab(\"Insurance Charges\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](ggplot2_files/figure-pdf/unnamed-chunk-7-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n### Violin Plots with `geom_violin()`\n\nViolin plots show the distribution of data across categories:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = insurance, mapping = aes(x = smoker, y = charges, fill = smoker)) + \n  geom_violin() +\n  ggtitle(\"Distribution of Insurance Charges by Smoking Status\") +\n  xlab(\"Smoker (Y/N)\") +\n  ylab(\"Insurance Charges\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](ggplot2_files/figure-pdf/unnamed-chunk-8-1.pdf){fig-pos='H'}\n:::\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}